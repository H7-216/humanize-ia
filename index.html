<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>CardSlayer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#00f2ff" />
  <link rel="manifest" href="manifest.json" />
  <style>
    * {
      margin: 0; padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    body {
      background: linear-gradient(135deg, #0d0d0d, #1f1f1f);
      color: #fff;
      text-align: center;
      min-height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 20px;
    }
    h1 {
      font-size: 3rem;
      margin: 20px 0;
      color: #00f2ff;
      text-shadow: 0 0 15px #00f2ff;
    }
    .menu, .level-select, .scoreboard, .game-board {
      display: none;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 0.5s ease-in-out;
    }
    .active {
      display: flex !important;
    }
    button {
      background: #00f2ff;
      color: #000;
      border: none;
      padding: 12px 24px;
      font-size: 1rem;
      margin: 10px;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 10px #00f2ff;
      transition: 0.3s;
    }
    button:hover {
      background: #00c2cc;
    }
    .stats {
      display: flex;
      gap: 20px;
      margin-bottom: 10px;
      font-size: 1rem;
    }
    .game-board {
      display: grid;
      gap: 10px;
      justify-content: center;
    }
    .card {
      background: #111;
      border: 2px solid #00f2ff;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      color: #000;
      transition: transform 0.3s, background 0.3s;
      cursor: pointer;
      position: relative;
    }
    .card span {
      visibility: hidden;
    }
    .card.flipped span {
      visibility: visible;
    }
    .card.flipped {
      background: #00f2ff;
      transform: rotateY(180deg);
    }
    .card.matched {
      background: #00ff88;
      border-color: #00ff88;
      cursor: default;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>

  <h1>ğŸ® CardSlayer</h1>

  <div class="menu active" id="menu">
    <button onclick="showLevelSelect()">â–¶ï¸ Jouer</button>
    <button onclick="showScores()">ğŸ† Scores</button>
    <button onclick="resetScores()">â™»ï¸ RÃ©initialiser Scores</button>
  </div>

  <div class="level-select" id="levelSelect">
    <h2>Choisis ton niveau :</h2>
    <button onclick="startGame('easy')">ğŸ˜Œ Facile (4x2)</button>
    <button onclick="startGame('medium')">ğŸ˜ Moyen (4x4)</button>
    <button onclick="startGame('hard')">ğŸ˜¤ Difficile (6x6)</button>
    <button onclick="goToMenu()">ğŸ”™ Retour</button>
  </div>

  <div class="scoreboard" id="scoreboard">
    <h2>Meilleurs Scores</h2>
    <div id="scoreList"></div>
    <button onclick="goToMenu()">ğŸ”™ Retour</button>
  </div>

  <div class="game-board" id="gameContainer">
    <div class="stats">
      â±ï¸ Temps : <span id="timer">0</span>s |
      ğŸ–±ï¸ Coups : <span id="clicks">0</span>
    </div>
    <div id="board"></div>
    <button onclick="goToMenu()">ğŸ  Menu</button>
  </div>
    <script>
    const emojis = ['ğŸ•','ğŸš€','ğŸ±','âš½','ğŸ”','ğŸ®','ğŸ²','ğŸ','ğŸ§ ','ğŸ‘¾','ğŸ“¦','ğŸ’£','ğŸ’','ğŸ“±','ğŸ“·','ğŸ‰','ğŸ§','ğŸ†'];
    const board = document.getElementById('board');
    const timerSpan = document.getElementById('timer');
    const clicksSpan = document.getElementById('clicks');
    const menu = document.getElementById('menu');
    const levelSelect = document.getElementById('levelSelect');
    const gameContainer = document.getElementById('gameContainer');
    const scoreboard = document.getElementById('scoreboard');
    const scoreList = document.getElementById('scoreList');

    let firstCard = null, lockBoard = false, clicks = 0, timer = 0, interval = null, difficulty = 'easy';

    const flipSound = new Audio('https://cdn.pixabay.com/download/audio/2022/03/15/audio_94a7f84874.mp3');
    const matchSound = new Audio('https://cdn.pixabay.com/download/audio/2022/02/23/audio_d678b40e47.mp3');
    const winSound = new Audio('https://cdn.pixabay.com/download/audio/2022/03/15/audio_d7487083ae.mp3');

    function showLevelSelect() {
      menu.classList.remove('active');
      levelSelect.classList.add('active');
    }

    function goToMenu() {
      stopTimer();
      gameContainer.classList.remove('active');
      scoreboard.classList.remove('active');
      levelSelect.classList.remove('active');
      menu.classList.add('active');
    }

    function showScores() {
      menu.classList.remove('active');
      scoreboard.classList.add('active');
      const scores = JSON.parse(localStorage.getItem('cardslayer-scores') || '{}');
      scoreList.innerHTML = '';
      ['easy','medium','hard'].forEach(level => {
        const s = scores[level];
        const line = document.createElement('p');
        line.innerHTML = `ğŸ”¹ <b>${level.toUpperCase()}</b> : ${s ? `${s.time}s, ${s.clicks} clics` : 'â€”'}`;
        scoreList.appendChild(line);
      });
    }

    function resetScores() {
      localStorage.removeItem('cardslayer-scores');
      alert('Scores rÃ©initialisÃ©s âœ…');
    }

    function getGridSize(level) {
      switch(level) {
        case 'easy': return [4, 2];
        case 'medium': return [4, 4];
        case 'hard': return [6, 6];
      }
    }

    function startGame(level) {
      difficulty = level;
      levelSelect.classList.remove('active');
      gameContainer.classList.add('active');

      const [cols, rows] = getGridSize(level);
      const pairCount = (cols * rows) / 2;
      const selected = emojis.slice(0, pairCount);
      const cards = shuffle([...selected, ...selected]);

      board.innerHTML = '';
      board.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

      cards.forEach((emoji, i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.emoji = emoji;
        card.innerHTML = `<span>${emoji}</span>`;
        card.addEventListener('click', flipCard);
        board.appendChild(card);
      });

      clicks = 0;
      timer = 0;
      clicksSpan.textContent = 0;
      timerSpan.textContent = 0;
      startTimer();
    }

    function flipCard() {
      if (lockBoard || this.classList.contains('flipped') || this.classList.contains('matched')) return;
      flipSound.play();
      this.classList.add('flipped');
      clicks++;
      clicksSpan.textContent = clicks;

      if (!firstCard) {
        firstCard = this;
      } else {
        lockBoard = true;
        if (this.dataset.emoji === firstCard.dataset.emoji) {
          this.classList.add('matched');
          firstCard.classList.add('matched');
          matchSound.play();
          resetTurn();
        } else {
          setTimeout(() => {
            this.classList.remove('flipped');
            firstCard.classList.remove('flipped');
            resetTurn();
          }, 700);
        }
      }
    }

    function resetTurn() {
      firstCard = null;
      lockBoard = false;
      checkWin();
    }

    function checkWin() {
      const matched = document.querySelectorAll('.card.matched');
      if (matched.length === document.querySelectorAll('.card').length) {
        stopTimer();
        winSound.play();
        saveScore();
        setTimeout(() => {
          alert(`ğŸ‰ GagnÃ© ! ${timer}s et ${clicks} clics`);
        }, 300);
      }
    }

    function saveScore() {
      const key = 'cardslayer-scores';
      const current = JSON.parse(localStorage.getItem(key) || '{}');
      const best = current[difficulty];
      if (!best || clicks < best.clicks || (clicks === best.clicks && timer < best.time)) {
        current[difficulty] = { clicks, time: timer };
        localStorage.setItem(key, JSON.stringify(current));
      }
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function startTimer() {
      stopTimer();
      interval = setInterval(() => {
        timer++;
        timerSpan.textContent = timer;
      }, 1000);
    }

    function stopTimer() {
      clearInterval(interval);
    }
  </script>
</body>
</html>